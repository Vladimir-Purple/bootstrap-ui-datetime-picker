// https://github.com/Gillardo/bootstrap-ui-datetime-picker
// Version: 1.1.7
// Released: 2015-08-26 
angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",enableDate:!0,enableTime:!0,todayText:"Today",nowText:"Now",clearText:"Clear",closeText:"Done",dateText:"Date",timeText:"Time",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datetimePicker",["$compile","$parse","$document","$timeout","$position","dateFilter","dateParser","uiDatetimePickerConfig",function(a,b,c,d,e,f,g,h){return{restrict:"A",require:"ngModel",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",disableMinutes:"@?",todayText:"@",hideToday:"@",todayClass:"@?",nowText:"@",hideNow:"@?",nowClass:"@?",dateText:"@",dateClass:"@?",timeText:"@",timeClass:"@?",clearText:"@",hideClear:"@",closeText:"@",closeClass:"@?",dateDisabled:"&",customButtonText:"@?",customButtonClass:"@?",customButtonAction:"&?",customButtonClose:"@?"},link:function(i,j,k,l){function m(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function n(a){return k.dateDisabled&&angular.isDefined(a)&&i.dateDisabled({date:a,mode:i.watchData.datepickerMode})}function o(a){if(a){if(angular.isDate(a)&&!isNaN(a))return l.$setValidity("date",!0),a;if(angular.isString(a)){var b=g.parse(a,q)||new Date(a);return isNaN(b)?void l.$setValidity("date",!1):(l.$setValidity("date",!0),b)}return void l.$setValidity("date",!1)}return l.$setValidity("date",!0),null}var p,q=h.dateFormat,r=angular.isDefined(k.closeOnDateSelection)?i.$parent.$eval(k.closeOnDateSelection):h.closeOnDateSelection,s=angular.isDefined(k.datepickerAppendToBody)?i.$parent.$eval(k.datepickerAppendToBody):h.appendToBody;if(i.showButtonBar=angular.isDefined(k.showButtonBar)?i.$parent.$eval(k.showButtonBar):h.showButtonBar,i.enableDate=angular.isDefined(i.enableDate)?i.enableDate:h.enableDate,i.enableTime=angular.isDefined(i.enableTime)?i.enableTime:h.enableTime,i.showPicker=i.enableDate?"date":"time","true"===i.customButtonClose){var t=i.customButtonAction;i.customButtonAction=null,i.customButtonAction=function(){t(),i.close()}}i.getText=function(a){return i[a+"Text"]||h[a+"Text"]},k.$observe("datetimePicker",function(a){q=a||h.dateFormat,l.$render()});var u=angular.element('<div date-picker-wrap ng-show="showPicker == \'date\'"><div datepicker></div></div><div time-picker-wrap ng-show="showPicker == \'time\'"><div timepicker style="margin:0 auto"></div></div>');u.attr({"ng-model":"date","ng-change":"dateSelection(date)"});var v=angular.element(u.children()[0]);k.datepickerOptions&&angular.forEach(i.$parent.$eval(k.datepickerOptions),function(a,b){v.attr(m(b),a)});var w=angular.element(u.children()[1]);k.timepickerOptions&&angular.forEach(i.$parent.$eval(k.timepickerOptions),function(a,b){w.attr(m(b),a)}),angular.isDefined(k.datepickerMode)||(k.datepickerMode="day"),i.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(a){if(k[a]){var c=b(k[a]);if(i.$parent.$watch(c,function(b){i.watchData[a]=b}),v.attr(m(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;i.$watch("watchData."+a,function(a,b){angular.isFunction(d)&&a!==b&&d(i.$parent,a)})}}}),k.dateDisabled&&v.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),l.$parsers.unshift(o),i.dateSelection=function(a){i.enableDate&&i.enableTime&&"time"===i.showPicker&&p&&null!==p&&(null!==i.date||a||null!=a)&&(a&&null!=a?(p.setHours(a.getHours()),p.setMinutes(a.getMinutes()),p.setSeconds(a.getSeconds()),p.setMilliseconds(a.getMilliseconds()),a=new Date(p)):(p.setHours(i.date.getHours()),p.setMinutes(i.date.getMinutes()),p.setSeconds(i.date.getSeconds()),p.setMilliseconds(i.date.getMilliseconds()))),angular.isDefined(a)&&("true"===i.disableMinutes&&(a.setMinutes(0),a.setMilliseconds(0)),i.date=a),p=i.date,l.$setViewValue(i.date),l.$render(),null===a?i.close():r&&"time"!=i.showPicker&&(i.enableTime?i.showPicker="time":i.close())},j.bind("input change keyup",function(){i.$apply(function(){i.date=l.$modelValue})}),l.$render=function(){var a=l.$viewValue?o(l.$viewValue):null,b=a?f(a,q):"";j.val(b),i.date=a};var x=function(a){i.isOpen&&a.target!==j[0]&&i.$apply(function(){i.isOpen=!1})},y=function(a,b){i.keydown(a)};j.bind("keydown",y),i.keydown=function(a){27===a.which?(a.preventDefault(),i.isOpen&&a.stopPropagation(),i.close()):40!==a.which||i.isOpen||(i.isOpen=!0)};var z=i.$watch("isOpen",function(a){if(i.dropdownStyle={display:a?"block":"none"},a){var b=s?e.offset(j):e.position(j);s?i.dropdownStyle.top=b.top+j.prop("offsetHeight")+"px":i.dropdownStyle.top=void 0,i.dropdownStyle.left=b.left+"px",d(function(){i.$broadcast("datepicker.focus"),c.bind("click",x)},0,!1)}else c.unbind("click",x)});i.isTodayDisabled=function(){return n(new Date)},i.select=function(a){if("today"===a||"now"==a){var b=new Date;angular.isDate(l.$modelValue)?(a=new Date(l.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),a.setHours(b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds())):a=b}i.dateSelection(a)},i.close=function(){i.isOpen=!1,j[0].focus()},i.changePicker=function(a,b){a.preventDefault(),a.stopPropagation(),i.showPicker=b};var A=a(u)(i);u.remove(),s?c.find("body").append(A):j.after(A),i.$on("$destroy",function(){i.isOpen===!0&&i.$apply(function(){i.isOpen=!1}),z(),A.remove(),j.unbind("keydown",y),c.unbind("click",x)})}}}]).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datetime-picker.html",link:function(a,b,c){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datetime-picker.html",link:function(a,b,c){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(a){"use strict";a.put("template/datetime-picker.html","<ul class=\"dropdown-menu dropdown-menu-left datetime-picker-dropdown\" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event)><li style=\"padding:0 5px 5px 5px\" ng-class=\"{'date-picker-menu': showPicker == 'date', 'time-picker-menu' : showPicker == 'time'}\"><div ng-transclude></div></li><li ng-if=showButtonBar style=padding:5px><span class=\"btn-group pull-left\" style=margin-right:10px><button ng-if=\"showPicker == 'date' && hideToday !== 'true'\" type=button class=\"btn btn-sm {{ todayClass || 'btn-info' }}\" ng-click=\"select('today')\" ng-disabled=isTodayDisabled()>{{ getText('today') }}</button> <button ng-if=\"showPicker == 'time' && hideNow !== 'true'\" type=button class=\"btn btn-sm {{ nowClass || 'btn-info' }}\" ng-click=\"select('now')\" ng-disabled=isTodayDisabled()>{{ getText('now') }}</button> <button ng-if=\"hideClear !== 'true'\" type=button class=\"btn btn-sm btn-danger\" ng-click=select(null)>{{ getText('clear') }}</button> <button ng-if=\"customButtonText.length > 0\" type=button class=\"btn btn-sm {{ customButtonClass || 'btn-info'}}\" ng-click=customButtonAction()>{{ customButtonText }}</button></span> <span class=\"btn-group pull-right\"><button ng-if=\"showPicker == 'date' && enableTime\" type=button class=\"btn btn-sm {{ timeClass || 'btn-default' }}\" ng-click=\"changePicker($event, 'time')\">{{ getText('time')}}</button> <button ng-if=\"showPicker == 'time' && enableDate\" type=button class=\"btn btn-sm {{ dateClass || 'btn-default' }}\" ng-click=\"changePicker($event, 'date')\">{{ getText('date')}}</button> <button type=button class=\"btn btn-sm {{ closeClass || 'btn-success' }}\" ng-click=close()>{{ getText('close') }}</button></span></li></ul>")}]);